% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ndx_gdlite.R
\name{cv_r2_loro}
\alias{cv_r2_loro}
\title{Calculate Leave-One-Run-Out Cross-Validated R-squared}
\usage{
cv_r2_loro(Y_fmri, X_design, run_idx)
}
\arguments{
\item{Y_fmri}{Numeric matrix of fMRI data (timepoints x voxels), concatenated
across all runs.}

\item{X_design}{Numeric matrix, the design matrix (timepoints x regressors) for the GLM.
This should correspond to the full `Y_fmri` matrix (concatenated across runs).}

\item{run_idx}{Numeric vector indicating run membership for each timepoint (row)
in `Y_fmri` and `X_design`.}
}
\value{
A numeric vector of length `ncol(Y_fmri)` containing the LORO
  cross-validated R-squared value for each voxel. If a voxel has zero variance
  in a test run, or if the GLM fit fails for a fold, its R-squared might be 0 or NA.
}
\description{
Computes the R-squared for each voxel using leave-one-run-out (LORO)
cross-validation. For each run, a GLM is fit to all other (training) runs,
and then used to predict the data in the left-out (test) run. The R-squared
is then calculated for each voxel based on the residuals from this prediction
in the test run.
}
