% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ndx_ridge.R
\name{ndx_solve_anisotropic_ridge}
\alias{ndx_solve_anisotropic_ridge}
\title{Solve Anisotropic Ridge Regression Problem}
\usage{
ndx_solve_anisotropic_ridge(
  Y_whitened,
  X_whitened,
  K_penalty_diag = NULL,
  na_mask = NULL,
  projection_mats = NULL,
  lambda_values = NULL,
  gcv_lambda = FALSE,
  res_var_scale = 1,
  lambda_grid = 10^seq(-2, 2, length.out = 5)
)
}
\arguments{
\item{Y_whitened}{A numeric matrix of whitened dependent variables (timepoints x voxels/responses).}

\item{X_whitened}{A numeric matrix of whitened regressors (timepoints x n_regressors).}

\item{K_penalty_diag}{A numeric vector containing the diagonal elements of the penalty matrix K.
Its length must be equal to `ncol(X_whitened)`.}

\item{na_mask}{Optional. A logical vector where TRUE indicates timepoints to exclude.
If NULL, all timepoints are used.}

\item{projection_mats}{Optional list of projection matrices produced by
\code{ndx_compute_projection_matrices}. Used when \code{K_penalty_diag} is not supplied.}

\item{lambda_values}{Optional list with lambda parameters (e.g., \code{lambda_parallel},
\code{lambda_perp_signal}) used to construct \code{K_penalty_diag} when it is not given.}
\item{gcv_lambda}{Logical flag to enable GCV tuning of \code{lambda_parallel}.}
\item{res_var_scale}{Residual variance estimate used to scale the GCV search grid.}
\item{lambda_grid}{Numeric vector of candidate lambda values for GCV.}
}
\value{
A list with components 
\code{betas} (matrix of estimated coefficients) and 
\code{chol_RtR} (Cholesky factor of the penalized normal equations; may be \code{NULL}).
Returns \code{NULL} if inputs are invalid or the problem cannot be solved.
}
\description{
Solves for beta coefficients in a ridge regression model: Y = X beta + E,
minimizing ||Y - X beta||^2 + beta^T K beta, where K is a diagonal penalty matrix.
Handles missing data specified by `na_mask` by removing corresponding timepoints.
}
