% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ndx_ridge.R
\name{ndx_solve_anisotropic_ridge}
\alias{ndx_solve_anisotropic_ridge}
\title{Solve Anisotropic Ridge Regression Problem}
\usage{
ndx_solve_anisotropic_ridge(
  Y_whitened,
  X_whitened,
  K_penalty_diag,
  na_mask = NULL
)
}
\arguments{
\item{Y_whitened}{A numeric matrix of whitened dependent variables (timepoints x voxels/responses).}

\item{X_whitened}{A numeric matrix of whitened regressors (timepoints x n_regressors).}

\item{K_penalty_diag}{A numeric vector containing the diagonal elements of the penalty matrix K.
Its length must be equal to `ncol(X_whitened)`.}

\item{na_mask}{Optional. A logical vector where TRUE indicates timepoints to exclude.
If NULL, all timepoints are used.}
}
\value{
A matrix of estimated beta coefficients (n_regressors x voxels/responses).
  Returns NULL if inputs are invalid or the problem cannot be solved.
}
\description{
Solves for beta coefficients in a ridge regression model: Y = X beta + E,
minimizing ||Y - X beta||^2 + beta^T K beta, where K is a diagonal penalty matrix.
Handles missing data specified by `na_mask` by removing corresponding timepoints.
}
