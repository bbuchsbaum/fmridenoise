% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ndx_hrf.R
\name{estimate_hrf_for_condition}
\alias{estimate_hrf_for_condition}
\title{Estimate FIR HRF for a Single Condition}
\usage{
estimate_hrf_for_condition(
  condition_name,
  events_for_condition,
  ybar_clean,
  block_ids_for_cv,
  overall_sampling_frame,
  valid_TRs_mask,
  TR,
  user_options
)
}
\arguments{
\item{condition_name}{Character, the name of the condition.}

\item{events_for_condition}{Data frame of events, already filtered for this specific condition.}

\item{ybar_clean}{Numeric vector, the robust mean time course of good voxels on valid TRs.}

\item{block_ids_for_cv}{Numeric vector, run/block IDs for `ybar_clean`.}

\item{overall_sampling_frame}{An `fmri_sampling_frame` object for all original TRs.}

\item{valid_TRs_mask}{Logical mask for all original TRs indicating validity for HRF estimation.}

\item{TR}{Numeric, repetition time.}

\item{user_options}{List of user options, including `hrf_fir_taps`, `lambda1_grid`, 
`lambda2_grid`, `cv_folds`, and `return_full_model`.}
}
\value{
A list containing:
  - `condition`: Character, the condition name.
  - `hrf_estimate`: Numeric vector of estimated FIR coefficients, or NULL if estimation fails.
  - `taps`: Integer vector of tap indices, or NULL.
  - `glmgen_fit`: The `glmgen::fusedlasso` model object if `user_options$return_full_model` is TRUE, else NULL.
}
\description{
Performs FIR design matrix generation, cross-validation for fused lasso parameters,
final model fitting, and post-processing for a single experimental condition.
}
\keyword{internal}
