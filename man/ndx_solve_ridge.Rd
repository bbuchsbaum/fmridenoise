% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ndx_ridge.R
\name{ndx_solve_ridge}
\alias{ndx_solve_ridge}
\title{Solve Ridge Regression for fMRI Data}
\usage{
ndx_solve_ridge(Y_whitened, X_whitened, lambda_ridge, na_mask = NULL)
}
\arguments{
\item{Y_whitened}{A numeric matrix (timepoints x voxels) of whitened fMRI data.
The first `order` rows (from AR pre-whitening) might be NA and should be handled (e.g. by removing them
along with corresponding rows in X_whitened before solving).}

\item{X_whitened}{A numeric matrix (timepoints x regressors) of the whitened design matrix.
Corresponding rows to NAs in Y_whitened should also be handled/removed.}

\item{lambda_ridge}{A single numeric value for the ridge penalty (lambda). For Sprint 1,
this is a fixed value. GCV selection can be added later.}

\item{na_mask}{An optional logical vector indicating rows to remove from Y_whitened and X_whitened
due to NA values (e.g., from AR filter initialization). If NULL (default), the function will
attempt to identify and remove rows with any NAs in Y_whitened.}
}
\value{
A matrix (regressors x voxels) of estimated beta coefficients (betas_whitened).
}
\description{
Solves the ridge regression problem for whitened fMRI data and a whitened design matrix.
For Sprint 1, this implements a basic isotropic ridge regression.
}
\details{
The ridge regression solution is `beta = (X'X + lambda * I)^(-1) X'Y`.
This function assumes `Y_whitened` and `X_whitened` have had initial NA rows
(e.g., from AR pre-whitening) removed or properly handled if `na_mask` is provided.
If `na_mask` is not provided, any row in `Y_whitened` containing at least one NA will lead to that row (and the
corresponding row in `X_whitened`) being removed before model fitting.
}
